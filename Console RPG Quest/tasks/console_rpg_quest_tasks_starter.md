# Стартовые задачи Console RPG Quest

25 шагов, которые превратят каркас в работающую текстовую RPG. У каждой задачи есть контекст, последовательность действий и ожидаемый результат.

## 1. Создание служебных каталогов
**Описание.** При запуске приложения должны появляться каталоги `data/`, `logs/`, `saves/`.
**Шаги реализации:**
- В `ConsoleRPGApplication` добавить подготовку директорий до инициализации UI.
- Использовать значения из `Settings` и `Path.mkdir(parents=True, exist_ok=True)`.
- Проверить существование файла сохранения и логов, при необходимости создавать пустые файлы.
**Результат.** После `python main.py` структура каталогов появляется автоматически.

---

## 2. Расширение настроек игры
**Описание.** Настройки должны описывать базовые параметры RPG.
**Шаги реализации:**
- Дополнить `Settings` стартовыми характеристиками игрока, список доступных классов, ограничение инвентаря.
- Вынести пути к файлам бестиария и предметов.
- Подготовить значения задержек анимаций боя и паузы между ходами.
**Результат.** Все слои получают доступ к расширенному набору констант.

---

## 3. Реализация логики предметов
**Описание.** Класс `Item` должен уметь применять эффект к целям.
**Шаги реализации:**
- Заполнить метод `apply_to`, принимающий персонажа и изменяющий здоровье, атаку или защиту.
- Добавить валидацию типа предмета ("weapon", "armor", "potion", "quest").
- Вернуть словарь с описанием изменений для последующего логирования.
**Результат.** Предметы влияют на характеристики персонажей согласно типу.

---

## 4. Базовый персонаж
**Описание.** Класс `Character` должен управлять здоровьем и инвентарём.
**Шаги реализации:**
- Реализовать `is_alive`, возвращающий `True`, если здоровье выше нуля.
- В `receive_damage` уменьшать здоровье с учётом защиты, не опуская ниже нуля.
- В `add_item` проверять вместимость инвентаря и добавлять предмет.
**Результат.** Любой персонаж корректно реагирует на урон и предметы.

---

## 5. Прокачка игрока
**Описание.** Игрок должен накапливать опыт и повышать уровень.
**Шаги реализации:**
- В `gain_experience` увеличивать опыт и проверять пороги повышения уровня.
- При повышении уровня увеличивать характеристики и сбрасывать опыт до остатка.
- Возвращать информацию о полученных бонусах.
**Результат.** Игрок прогрессирует при получении опыта.

---

## 6. Выбор действия игрока
**Описание.** Метод `choose_action` должен подготавливать действия для боя.
**Шаги реализации:**
- Принимать контекст боя и список доступных опций.
- Возвращать объект с типом действия и дополнительными параметрами.
- Подготовить ветки для атаки, защиты, использования предмета и навыка.
**Результат.** В бою игрок может выбрать действие, понятное сервисному слою.

---

## 7. Поведение врага
**Описание.** Класс `Enemy` должен принимать решения в бою.
**Шаги реализации:**
- Реализовать `decide_move`, учитывающий здоровье врага, тип поведения и доступные навыки.
- Возвращать `TurnAction` с типом "attack", "skill" или "flee".
- Добавить поддержку специальных приёмов из лут-таблицы.
**Результат.** Враги действуют осмысленно и разнообразно.

---

## 8. Проверка условий квеста
**Описание.** Метод `is_ready_to_complete` определяет завершение квеста.
**Шаги реализации:**
- Проверять выполнение всех целей в `objectives` по данным игрока.
- Поддержать типы целей: победить врага, собрать предмет, посетить локацию.
- Возвращать булево значение и список невыполненных шагов.
**Результат.** Квесты корректно переходят в состояние завершения.

---

## 9. Награды квеста
**Описание.** `apply_rewards` должен выдавать бонусы игроку.
**Шаги реализации:**
- Добавить обработку наград: опыт, золото, предметы, изменение репутации.
- Использовать методы игрока для добавления предметов и опыта.
- Помечать квест выполненным после применения наград.
**Результат.** Завершённые квесты приносят игроку выгоду.

---

## 10. Обновление времени суток
**Описание.** Мир должен отслеживать смену времени.
**Шаги реализации:**
- В `GameWorld.advance_time` циклически переключать время суток: утро → день → вечер → ночь.
- Вызывать генерацию случайных событий в зависимости от периода.
- Возвращать описание изменений для вывода в UI.
**Результат.** Мир реагирует на время и создаёт атмосферу.

---

## 11. Появление врагов
**Описание.** Метод `spawn_enemy` управляет созданием врагов в сцене.
**Шаги реализации:**
- Добавлять врага в `active_enemies`, учитывая лимит на локацию.
- Применять модификаторы сложности из `Settings`.
- Возвращать справку для журнала событий.
**Результат.** Враги появляются в мире контролируемо.

---

## 12. Назначение квестов
**Описание.** `start_quest` должен устанавливать активный квест игроку.
**Шаги реализации:**
- Проверять, что у игрока нет другого активного сюжетного квеста.
- Добавлять запись в журнал мира и обновлять состояние игрока.
- Возвращать текстовое подтверждение для UI.
**Результат.** Игрок может брать новые задания.

---

## 13. Управление очередностью ходов
**Описание.** `BattleContext.next_turn` задаёт порядок действий.
**Шаги реализации:**
- Формировать очередь из игрока и врага с учётом инициативы.
- Переходить к следующему участнику, увеличивая номер раунда после обоих ходов.
- Возвращать текущего актёра для обработки.
**Результат.** Бой выполняется в корректном порядке.

---

## 14. Проверка завершения боя
**Описание.** Метод `is_finished` определяет конец поединка.
**Шаги реализации:**
- Проверять состояние здоровья игрока и врага.
- Отслеживать флаг побега или сдачи.
- Возвращать булево значение и причину завершения.
**Результат.** Бой завершается корректно при выполнении условий.

---

## 15. Разрешение действий
**Описание.** `TurnAction.resolve` применяет выбранное действие.
**Шаги реализации:**
- Поддержать типы: "attack", "defend", "item", "skill".
- Для атак рассчитывать урон, учитывая защиту цели.
- Формировать структуру результата для логов и лута.
**Результат.** Бой обрабатывает действия участников.

---

## 16. Проверка трофеев
**Описание.** `LootDrop.is_empty` должен сообщать о наличии наград.
**Шаги реализации:**
- Возвращать `True`, если список предметов пуст и золото равно нулю.
- Подготовить строковое представление для логов.
- Добавить метод, собирающий добычу игроком.
**Результат.** Лут корректно анализируется после боя.

---

## 17. Загрузка сохранения
**Описание.** `SaveRepository.load` читает JSON-файл прогресса.
**Шаги реализации:**
- Использовать `json.load` и обработку отсутствующего файла.
- Возвращать словарь с данными и версией.
- Логировать ошибки чтения.
**Результат.** Сохранение корректно загружается в память.

---

## 18. Сохранение прогресса
**Описание.** `SaveRepository.save` записывает состояние мира.
**Шаги реализации:**
- Принимать сериализованные данные и сохранять через `json.dump` с отступами.
- Создавать каталоги при необходимости.
- Возвращать путь к сохранённому файлу.
**Результат.** Прогресс игрока фиксируется на диске.

---

## 19. Резервное копирование
**Описание.** Метод `backup` создаёт копию сохранения.
**Шаги реализации:**
- Формировать имя резервного файла с отметкой времени.
- Копировать содержимое текущего сохранения в новую локацию.
- Ограничивать количество резервных копий (оставлять последние N).
**Результат.** Игрок защищён от потери данных.

---

## 20. Загрузка библиотеки квестов
**Описание.** `QuestLoader.load_all` возвращает определения квестов.
**Шаги реализации:**
- Читать JSON-файл `Settings.QUEST_LIBRARY`.
- Валидировать структуру с помощью `validate_schema`.
- Создавать объекты `Quest` и возвращать список.
**Результат.** Квесты становятся доступными сервисному слою.

---

## 21. Проверка структуры квестов
**Описание.** `validate_schema` подтверждает корректность данных.
**Шаги реализации:**
- Проверять обязательные поля: `id`, `title`, `objectives`, `rewards`.
- Убеждаться, что цели и награды указаны в допустимых форматах.
- Возвращать отчёт об ошибках или `None` при успехе.
**Результат.** Некорректные файлы квестов выявляются заранее.

---

## 22. Старт новой игры
**Описание.** `GameService.start_new_game` инициализирует прогресс.
**Шаги реализации:**
- Сбрасывать мир, устанавливать имя игрока и начальный класс.
- Загружать стартовые квесты и добавлять в журнал событий приветствие.
- Вызывать создание базового инвентаря.
**Результат.** Новая игра корректно подготавливается к началу приключения.

---

## 23. Добавление предметов игроку
**Описание.** Метод `add_item_to_player` управляет наградами.
**Шаги реализации:**
- Вызывать `player.add_item` и обрабатывать переполнение.
- Записывать событие в `log` с описанием предмета.
- Возвращать информацию для UI.
**Результат.** Игрок получает предметы с сопровождающими сообщениями.

---

## 24. Формирование сводки
**Описание.** `build_summary` должен подготавливать текст отчёта.
**Шаги реализации:**
- Собрать характеристики игрока, активный квест, состояние времени суток.
- Добавить список последних событий из `log`.
- Вернуть готовую строку для вывода.
**Результат.** Сервис предоставляет краткий обзор состояния игры.

---

## 25. Отображение сводки в UI
**Описание.** `ConsoleInterface.display_summary` выводит результат работы сервиса.
**Шаги реализации:**
- Вызывать `build_summary` и печатать его в консоль.
- Добавить декоративные разделители и подсказки по управлению.
- Подготовить сообщение о том, что функциональность появится в следующих итерациях.
**Результат.** Пользователь видит сводку после запуска и понимает план развития игры.
