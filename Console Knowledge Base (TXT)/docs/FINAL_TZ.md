# Console Knowledge Base (TXT) — техническое задание

> ℹ️ В репозитории реализован только каркас приложения. Требования ниже описывают итоговый продукт, который предстоит
> разработать на основе задач из каталога `tasks/`.

## 1. Назначение и цели
Console Knowledge Base — консольное приложение для хранения заметок в виде отдельных `.txt`-файлов. Пользователь создаёт заметки,
структурирует ключевые слова и выполняет поиск по индексу. Система поддерживает экспорт всех заметок в один файл и ведёт
обновляемый индекс.

Цели команды:
- реализовать модульный проект на Python c разделением слоёв (core, storage, services, ui);
- отработать файловые операции и работу с путями через `os` и `pathlib`;
- потренироваться в проектировании текстовых интерфейсов и индексаторов.

## 2. Роли и сценарии
Основной пользователь — автор заметок. Он взаимодействует через консольные команды:
- создание заметки с заголовком, содержанием и ключевыми словами;
- просмотр списка заметок и чтение отдельного файла;
- поиск заметок по ключевому слову или фрагменту текста;
- обновление заметки и ключевых слов;
- удаление заметки вместе с файлом;
- экспорт всех заметок в общий текстовый файл;
- восстановление индекса после прямого редактирования файлов.

## 3. Архитектура
```
main.py ─▶ ConsoleApplication ─▶ CommandLoop (ui)
                                ├─▶ NoteService (services)
                                │     └─▶ KnowledgeBase (core)
                                │          └─▶ Note (core)
                                └─▶ TxtRepository (storage)
```

- **core**: модели заметок, индексатор, операции над коллекцией.
- **services**: бизнес-сценарии создания, поиска, экспорта и синхронизации с файловой системой.
- **storage**: чтение и запись `.txt`-файлов, поддержка индексного файла и экспортов.
- **ui**: консольный цикл команд, подсказки, форматирование вывода.

## 4. Требования к функциональности
- Хранение заметок в каталоге `notes/`, одна заметка — один `.txt`-файл.
- Индекс ключевых слов сохраняется в `index/index.txt` в виде человекочитаемого списка.
- Возможность указать относительный или абсолютный путь для каталога заметок в настройках.
- Поддержка CRUD-операций: создание, чтение, обновление, удаление заметок.
- Поиск по ключевому слову и полнотекстовый поиск по содержанию файлов.
- Экспорт всех заметок в `exports/all_notes.txt` с разделителями и метаданными.
- Защита от конфликтов имён файлов: преобразование заголовка к безопасному имени.
- Логирование основных операций в `logs/app.log` (создание, удаление, экспорт).
- Проверка наличия необходимых директорий при запуске приложения.

## 5. Требования к UX и интерфейсу
- Приложение запускается командой `python main.py` и показывает приветствие, список доступных команд и краткие инструкции.
- Навигация по командам осуществляется через простые текстовые команды (`create`, `list`, `view`, `search`, `delete`, `export`,
  `reindex`, `help`, `exit`).
- Все операции подтверждаются сообщениями об успехе или с понятными ошибками.
- Формат списка заметок: порядковый номер, заголовок, дата изменения, ключевые слова.
- Просмотр заметки выводит заголовок, ключевые слова и содержимое.

## 6. Требования к данным
- Структура заметки: заголовок, список ключевых слов, имя файла, содержимое, дата создания, дата изменения.
- Внутри `.txt`-файла хранятся заголовок, блок ключевых слов и текст заметки.
- Индекс содержит строки вида `ключевое_слово: список_файлов`.
- Поддержка кодировки UTF-8 без BOM.

## 7. Служебные файлы и каталоги
- `notes/` — рабочий каталог заметок.
- `index/index.txt` — индекс ключевых слов.
- `exports/all_notes.txt` — файл экспорта всех заметок.
- `logs/app.log` — лог операций.
- Настройки каталога берутся из `settings.py`, пути создаются автоматически при первом запуске.

## 8. Минимальные нефункциональные требования
- Приложение работает без сторонних зависимостей.
- Обработка ошибок файловой системы без аварийного завершения: вывод понятных сообщений.
- Покрытие сценариев команд тестовыми заметками в примерах, описанных в документации.
- Чёткое разделение логики между слоями, отсутствие прямой работы с файловой системой в UI.

## 9. Результирующие артефакты
- Консольное приложение, управляющее заметками.
- Каталоги `notes/`, `index/`, `exports/`, `logs/`, создаваемые автоматически.
- Текстовый индекс ключевых слов.
- Отчёт об экспорте всех заметок.
- Подробное руководство пользователя в README (дополняется при разработке).
