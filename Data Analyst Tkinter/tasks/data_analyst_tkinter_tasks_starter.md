# Стартовые задачи Data Analyst Tkinter

Набор из 25 шагов для превращения каркаса в рабочее настольное приложение анализа CSV.
Каждая задача содержит контекст, ожидаемые изменения и критерий готовности.

## 1. Подготовка служебных каталогов
**Описание.** Создать каталоги `data/`, `reports/`, `logs/`, `state/` при запуске приложения.
**Шаги реализации:**
- Обновить `Settings`, добавив путь к журналу и проверку директорий.
- Вызвать `ensure_directories` при старте приложения.
- Убедиться, что каталоги создаются даже без CSV.
**Результат.** После запуска `python main.py` в проекте существуют нужные каталоги без ошибок.

---

## 2. Расширение SessionState
**Описание.** Хранить в состоянии не только таблицу, но и фильтры пользователя.
**Шаги реализации:**
- Добавить поля для активных фильтров и выбранных столбцов.
- Реализовать методы добавления и сброса фильтров.
- Обновить существующие методы, чтобы не стирать фильтры при загрузке таблицы.
**Результат.** Объект состояния корректно хранит все части пользовательской сессии.

---

## 3. Реализация CsvDatasetLoader.read
**Описание.** Превратить метод чтения CSV в рабочий.
**Шаги реализации:**
- Использовать `csv.DictReader` и поддержку разных разделителей.
- Создавать `DataRow` для каждой строки.
- Обрабатывать пустые строки и ошибки чтения.
**Результат.** Метод возвращает список `DataRow` на основе выбранного файла.

---

## 4. Определение списка столбцов
**Описание.** Научить таблицу хранить имена столбцов.
**Шаги реализации:**
- Расширить `DataTable.load_rows`, чтобы формировать список колонок.
- Использовать `CsvDatasetLoader.detect_columns` как вспомогательный метод.
- Обеспечить защиту от дублирования заголовков.
**Результат.** После загрузки таблицы `column_names()` возвращает уникальный список столбцов.

---

## 5. Методы работы с DataRow
**Описание.** Предоставить удобные методы доступа к значениям строки.
**Шаги реализации:**
- Добавить методы `keys`, `items`, `as_dict`.
- Реализовать защиту от прямого изменения внутреннего словаря.
- Обновить существующие методы `get` и `set` для проверки ключей.
**Результат.** Строки позволяют безопасно читать и изменять данные.

---

## 6. Регистрация статистики
**Описание.** Заполнить методы `ColumnStats`.
**Шаги реализации:**
- В `register_value` обновлять минимум, максимум и суммарное значение.
- В `register_missing` увеличивать счётчик пропусков.
- В `finalize` вычислять среднее и округлять до 2 знаков.
**Результат.** Объект статистики аккумулирует данные и выдаёт агрегаты.

---

## 7. Сбор статистики в DataTable
**Описание.** Добавить логику расчёта статистик по столбцам.
**Шаги реализации:**
- Реализовать `summarize`, создавая `ColumnStats` для числовых полей.
- Определять числовые столбцы по возможности преобразования в `float`.
- Возвращать список статистик для отображения в UI.
**Результат.** Таблица способна вычислять базовые показатели по числовым колонкам.

---

## 8. Фильтрация строк
**Описание.** Подготовить метод фильтрации в таблице.
**Шаги реализации:**
- Реализовать `filter_rows`, принимающий предикат.
- Возвращать новый список `DataRow` без модификации исходных данных.
- Позволить комбинировать несколько фильтров.
**Результат.** Таблица предоставляет универсальную фильтрацию для сервиса.

---

## 9. Загрузка CSV из сервиса
**Описание.** Подключить `CsvDatasetLoader` к сервису.
**Шаги реализации:**
- Обновить `DataAnalysisService.load_dataset`, чтобы сохранять столбцы и количество строк.
- Передавать полученный список в `DataTable` и возвращать таблицу.
- Дополнить метод логированием успешной загрузки.
**Результат.** При выборе файла данные попадают в состояние и готовы к анализу.

---

## 10. Расчёт статистики в сервисе
**Описание.** Использовать методы таблицы для получения статистик.
**Шаги реализации:**
- Обновить `calculate_statistics`, передавая список числовых колонок в `summarize`.
- Сохранять результат в состоянии и возвращать данные для UI.
- Обрабатывать случаи отсутствия таблицы.
**Результат.** Сервис выдаёт статистику для отображения и сохранения.

---

## 11. Экспорт отчётов
**Описание.** Заполнить метод `export_reports`.
**Шаги реализации:**
- Сформировать строки с общей информацией и статистикой.
- Использовать `ReportWriter.write_report` для `summary`, `stats`, `missing`.
- Обновить состояние после успешного экспорта.
**Результат.** После нажатия кнопки отчёты появляются в каталоге `reports/`.

---

## 12. Хранение последнего файла
**Описание.** Запоминать путь к CSV между сессиями.
**Шаги реализации:**
- В `prepare_environment` получать значение из `ReportWriter`.
- Обновить UI, чтобы предлагать открыть последний файл автоматически.
- Добавить обработку отсутствия файла.
**Результат.** После перезапуска приложение предлагает предыдущий путь.

---

## 13. Приветственный экран
**Описание.** Обновить приветствие с инструкциями.
**Шаги реализации:**
- Дополнить окно текстом о том, что функциональность появится позже.
- Указать расположение отчётов и логов.
- Сделать показ приветствия опциональным через флаг в состоянии.
**Результат.** Пользователь получает понятное объяснение при первом запуске.

---

## 14. Логирование действий
**Описание.** Настроить журнал операций.
**Шаги реализации:**
- Добавить модуль `logging` в приложение.
- Логировать запуск, выбор файла, экспорт отчётов и ошибки.
- Сохранять журнал в `logs/app.log`.
**Результат.** Все ключевые события фиксируются для отладки.

---

## 15. Предпросмотр данных
**Описание.** Показать первые строки CSV в интерфейсе.
**Шаги реализации:**
- Добавить виджет `tk.Text` или `ttk.Treeview` для показа данных.
- Заполнять предпросмотр после успешной загрузки.
- Обновлять представление при повторном выборе файла.
**Результат.** Пользователь видит структуру данных до анализа.

---

## 16. Панель статистики
**Описание.** Отобразить рассчитанные показатели в UI.
**Шаги реализации:**
- Добавить отдельный фрейм с таблицей статистик.
- Форматировать значения (минимум, максимум, среднее, пропуски).
- Обновлять панель при каждом анализе.
**Результат.** Статистика отображается наглядно и обновляется автоматически.

---

## 17. Форма фильтрации
**Описание.** Создать диалог для ввода условий фильтрации.
**Шаги реализации:**
- Реализовать модальное окно с выбором столбца, операции и значения.
- Сохранять настройки в `SessionState`.
- Применять фильтр к таблице и обновлять предпросмотр.
**Результат.** Пользователь может фильтровать данные без написания кода.

---

## 18. Сброс фильтров
**Описание.** Добавить кнопку очистки фильтров.
**Шаги реализации:**
- Реализовать метод в сервисе, возвращающий полную таблицу.
- Обновлять UI и состояние после очистки.
- Логировать действие.
**Результат.** Пользователь легко возвращается к исходным данным.

---

## 19. Информация о столбцах
**Описание.** Показывать тип данных и примеры значений.
**Шаги реализации:**
- Определять тип столбца (числовой/строковый/дата).
- Отображать первые три значения в панели статистики.
- Сохранить данные в состоянии для повторного использования.
**Результат.** Пользователь быстро понимает структуру набора данных.

---

## 20. Обработка ошибок загрузки
**Описание.** Перехватывать ошибки чтения и показывать подсказки.
**Шаги реализации:**
- Добавить исключения при неверной кодировке или разделителе.
- Выводить сообщение через `messagebox.showerror`.
- Логировать подробную информацию в файл.
**Результат.** Приложение стабильно работает с различными CSV и объясняет проблемы.

---

## 21. Экспорт текущего вида
**Описание.** Позволить сохранить отфильтрованные данные в новый CSV.
**Шаги реализации:**
- Реализовать метод в сервисе для экспорта текущего списка строк.
- Добавить диалог выбора пути сохранения.
- Сохранять отчёт о действии в журнал.
**Результат.** Пользователь может делиться результатом анализа с коллегами.

---

## 22. Отчёт о пропусках
**Описание.** Сформировать отдельный текстовый файл `missing.txt`.
**Шаги реализации:**
- Анализировать столбцы на наличие пустых значений.
- Записывать их количество и проценты пропусков.
- Добавить кнопку обновления отчёта в UI.
**Результат.** Пользователь видит проблемные поля и может их обработать.

---

## 23. Сохранение настроек окна
**Описание.** Запоминать размер и позицию главного окна.
**Шаги реализации:**
- Сохранять геометрию при закрытии.
- Восстанавливать её при следующем запуске.
- Использовать каталог `state/` для хранения конфигурации.
**Результат.** Приложение открывается в удобном месте с выбранным размером.

---

## 24. Горячие клавиши
**Описание.** Добавить сочетания клавиш для ключевых действий.
**Шаги реализации:**
- Назначить `Ctrl+O` для открытия файла, `Ctrl+E` для экспорта отчётов.
- Подключить обработчики событий клавиатуры.
- Обновить инструкцию в приветственном окне.
**Результат.** Опытные пользователи работают быстрее.

---

## 25. Завершение работы
**Описание.** Реализовать корректное закрытие приложения.
**Шаги реализации:**
- Перехватить событие закрытия окна.
- Сохранить состояние и записать запись в журнал.
- Освободить ресурсы и завершить цикл.
**Результат.** Приложение закрывается без предупреждений и сохраняет прогресс пользователя.
